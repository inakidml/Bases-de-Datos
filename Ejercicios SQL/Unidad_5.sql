CREATE TABLE prueba
(codigo varchar2(3) CONSTRAINT pru_cod_pk PRIMARY KEY,
descripcion VARCHAR2(15) CONSTRAINT pru_des_nn NOT NULL,
nombre VARCHAR2(15) CONSTRAINT pru_nom_uk UNIQUE 
CONSTRAINT pru_nom_nn NOT NULL,
titulo VARCHAR2(10)
);

/*EJERCICIO 1*/
CREATE TABLE EJEMPLO(
NIF VARCHAR2(9) NOT NULL,
NOMBRE VARCHAR2(10) CONSTRAINT eje_nom_nn NOT NULL
)
INSERT INTO EJEMPLO VALUES ('44686055', 'inaki');
INSERT INTO EJEMPLO VALUES ('44686055', NULL);
INSERT INTO EJEMPLO VALUES (NULL, 'inaki');
INSERT INTO EJEMPLO VALUES ('', 'inaki');

/*ejercicio 2*/
CREATE TABLE EJEMPLO1_U
(
DNI VARCHAR2(9),
NOMBRE VARCHAR2(10) CONSTRAINT EJ1_NOM_UK UNIQUE,
EDAD NUMBER(2)
);

INSERT INTO EJEMPLO1_U VALUES('12345689a', 'EIDER', '23');

CREATE TABLE EJEMPLO2_U
(
NOMBRE VARCHAR2(10),
EDAD NUMBER(2),
CONSTRAINT EJ2_NOM_UK UNIQUE(NOMBRE,EDAD)
);
INSERT INTO EJEMPLO2_U VALUES('EIDER', '23');
INSERT INTO EJEMPLO2_U VALUES('EIDER', '22');
INSERT INTO EJEMPLO2_U VALUES('EIDER', '23');


SELECT * FROM EJEMPLO2_U;

DESC EJEMPLO2_U;
DESC PRUEBA;
/*EJEMPLO3*/
CREATE TABLE EJEMPLO1 (
DNI VARCHAR2(10) CONSTRAINT EJ1_DNI_NN NOT NULL,
NOMBRE VARCHAR2(29)CONSTRAINT EJ1_NOM_NN NOT NULL,
EDAD NUMBER(2),
FECHA DATE DEFAULT SYSDATE
);

DESC EJEMPLO1;

INSERT INTO EJEMPLO1 (DNI, NOMBRE, EDAD) VALUES('44685678e', 'INAKI', '34');
SELECT * FROM EJEMPLO1;
INSERT INTO EJEMPLO1 VALUES('44683678e', 'INI', '34', '23/12/2015');


CREATE TABLE EJEMPLO2(
DNI VARCHAR2(10) ,
NOMBRE VARCHAR2(29) DEFAULT 'No Definido',
USUARIO VARCHAR(10) DEFAULT UID
);

INSERT INTO EJEMPLO2 (dni) VALUES('44683678e');

SELECT * FROM EJEMPLO2;

/*Ejercicio 5*/

CREATE TABLE ALUMNOS(
DNI VARCHAR2(10) CONSTRAINT ALM_DNI_PK PRIMARY KEY,
NOMBRE VARCHAR2(30) CONSTRAINT ALM_NOM_NN NOT NULL
                    CONSTRAINT ALM_NOM_UPPER CHECK (NOMBRE=UPPER(NOMBRE)),
EDAD NUMBER(2) CONSTRAINT ALM_EDA_MAYOR4 CHECK (4<EDAD)/*(EDAD BETWEEN 5 AND 20)*/
               CONSTRAINT ALM_EDA_MENOR21 CHECK (EDAD<21),
CURSO NUMBER CONSTRAINT ALM_CUR_MAYOR0 CHECK (0<CURSO) /*(CURSO IN(1,2,3))*/
             CONSTRAINT ALM_CUR_MENOR4 CHECK (CURSO<4)
);

INSERT INTO ALUMNOS VALUES('44683648e','Inaki',5,3);
SELECT * FROM ALUMNOS;

/*EJERCICO 9 */

ALTER TABLE ALUMNOS ADD(Sexo VARCHAR2(10), IMPORTE NUMBER(5));
ALTER TABLE ALUMNOS ADD(SEXO CHAR(1) DEFAULT '?');
ALTER TABLE ALUMNOS MODIFY(SEXO CONSTRAINT ALM_SEX_NN NOT NULL);
ALTER TABLE ALUMNOS MODIFY(IMPORTE DEFAULT 0 );
INSERT INTO ALUMNOS VALUES('44683646e','PEPE',5,3,'Hombre', 1200);
INSERT INTO ALUMNOS VALUES('34583646e','PEPITO',7,2,'Hombre',null);
ALTER TABLE ALUMNOS MODIFY(IMPORTE DEFAULT 0 );
INSERT INTO ALUMNOS VALUES('34875646e','GVFLN',7,2,'Hombre',NULL);
ALTER TABLE ALUMNOS DROP(SEXO);
INSERT INTO ALUMNOS(DNI,NOMBRE,EDAD,CURSO,SEXO) VALUES('44234','PEREPE', 5,2,'M');

/*EJERCICIO 10*/

ALTER TABLE ALUMNOS DROP(EDAD);
SELECT * FROM ALUMNOS;
ALTER TABLE ALUMNOS ADD(FECHA_NACIMIENTO DATE, FECHA_ALTA DATE);
ALTER TABLE ALUMNOS RENAME column IMPORTE TO TASAS;
DESC TABLE ALUMNOS;
ALTER TABLE ALUMNOS ADD CONSTRAINT ALM_FEC_CH CHECK (FECHA_NACIMIENTO<FECHA_ALTA);
ALTER TABLE ALUMNOS DROP(FECHA_NACIMIENTO);

ALTER TABLE ALUMNOS DROP (FECHA_NACIMIENTO) CASCADE CONSTRAINT;

/*EJERCICO 11 */

CREATE TABLE EMPLADO(
EMP_NO NUMBER(4)NOT NULL, APELLIDO VARCHAR2(10), 
OFICIO VARCHAR2(10), DIR NUMBER(4), FECHA_ALT DATE, 
SALARIO NUMBER(10),
COMISION NUMBER(10), DEPT_NO NUMBER(2) NOT NULL
);
DESC EMPLEADO;
RENAME EMPLADO TO EMPLEADO;
ALTER TABLE EMPLEADO ADD CONSTRAINT EMP_APE_UK UNIQUE(APELLIDO);
/*ESTONO FUNCIONA
ALTER TABLE EMPLEADO ADD CONSTRAINT EMP_COM_NN NOT NULL (COMISION);
ALTER TABLE EMPLEADO ADD CONSTRAINT EMP_APE_NN NOT NULL (APELLIDO);
*/
/* TRUCO PARA Aï¿½ADIR UN CONSTRAINT A UN NOT NULL EXISTENTE*/
ALTER TABLE EMPLEADO MODIFY COMISION NOT NULL;
ALTER TABLE EMPLEADO ADD CONSTRAINT EMP_COM_NN CHECK(COMISION IS NOT NULL);
ALTER TABLE EMPLEADO MODIFY APELLIDO NOT NULL;
ALTER TABLE EMPLEADO ADD CONSTRAINT EMP_APE_NN CHECK(APELLIDO IS NOT NULL);


/* TEORIA*/
DESCRIBE USER_TABLES;
SELECT * FROM ALL_TABLES;
DESCRIBE ALL_TABLES;

SELECT * FROM USER_TAB_COLUMNS;
SELECT * FROM USER_CONSTRAINTS;
SELECT * FROM USER_CONS_COLUMNS;

/*EJERCICO 4*/
CREATE TABLE BLOQUESPISOS(
CALLE VARCHAR2(30),
NUMERO NUMBER(3),
PISO NUMBER(2),
PUERTA CHAR(1),
CODIGO_POSTAL NUMBER(5),
METROS NUMBER(5),
COMENTARIOS VARCHAR2(60),
COD_ZONA NUMBER(2),
DNI VARCHAR2(10),
CONSTRAINT BLO_PK PRIMARY KEY(CALLE,NUMERO,PISO, PUERTA)
);

CREATE TABLE ZONAS(
COD_ZONA NUMBER(3) CONSTRAINT ZON_COD_pK PRIMARY KEY,
NOMBREZONA VARCHAR2(20),
MASDATOS VARCHAR2(50)
);

/*EJERCICIO 12*/

SELECT * FROM USER_CONSTRAINTS;
SELECT CONSTRAINT_NAME FROM USER_CONSTRAINTS WHERE TABLE_NAME = 'EMPLEADO';
ALTER TABLE EMPLEADO DROP CONSTRAINT SYS_C0019585;
ALTER TABLE EMPLEADO DROP CONSTRAINT SYS_C0019586;
ALTER TABLE EMPLEADO DROP CONSTRAINT SYS_C0019601;
ALTER TABLE EMPLEADO DROP CONSTRAINT SYS_C0019607;

ALTER TABLE EMPLEADO DROP CONSTRAINT EMP_APE_UK;
/*SEGUNDA OPCION PARA ELIMINAR UNIQUE*/
ALTER TABLE EMPLEADO DROP UNIQUE(APELLIDO);

/*EJERCICIO13*/

ALTER TABLE BLOQUESPISOS MODIFY COD_ZONA NUMBER(3);
ALTER TABLE BLOQUESPISOS ADD CONSTRAINT BLO_COD_FK FOREIGN KEY(COD_ZONA) REFERENCES ZONAS(COD_ZONA) ON DELETE SET NULL; 
SELECT * FROM USER_CONSTRAINTS WHERE TABLE_NAME = 'BLOQUESPISOS';
ALTER TABLE ZONAS DROP PRIMARY KEY CASCADE;

/*EJERCICIO 14*/

SELECT CONSTRAINT_NAME, TABLE_NAME, CONSTRAINT_TYPE 
FROM USER_CONSTRAINTS WHERE TABLE_NAME = 'ALUMNOS';

    /*SI QUE HAY RESTRICCIï¿½N TIPO NOT NULL, PERO SON DE TIPO CHECK*/
    
    
/*EJERCICIO 15*/
SELECT * FROM USER_CONS_COLUMNS WHERE TABLE_NAME = 'BLOQUESPISOS' OR TABLE_NAME = 'ZONAS';

/*EJERCICIO 16*/
SELECT TABLE_NAME, TABLESPACE_NAME FROM USER_TABLES;

/* Ejercicio 17*/

SELECT TABLE_NAME, CONSTRAINT_NAME, CONSTRAINT_TYPE
FROM USER_CONSTRAINTS 
WHERE TABLE_NAME IN ('PROVINCIAS', 'PERSONAS');

/* EJERCICIO 18 */

TRUNCATE TABLE ALUMNOS;

DELETE FROM ALUMNOS;



/*Ejercicio 19*/

CREATE TABLE DEPART (
DEPT_NO NUMBER(2) CONSTRAINT DEP_PK PRIMARY KEY,
DNOMBRE VARCHAR2(14),
LOC VARCHAR2(14));
INSERT INTO DEPART VALUES(10, 'CONTABILIDAD', 'SEVILLA');
INSERT INTO DEPART VALUES(20, 'INVESTIGACION', 'MADRID');
INSERT INTO DEPART VALUES(30, 'VENTAS', 'BARCELONA');
INSERT INTO DEPART VALUES(40, 'PRODUCCION', 'BILBAO');
SELECT * FROM DEPART;

CREATE TABLE EMPLE (
 	EMP_NO    NUMBER(4) CONSTRAINT EMP_PK PRIMARY KEY,
 	APELLIDO  VARCHAR2(10),
 	OFICIO    VARCHAR2(10),
 	DIR       NUMBER(4) CONSTRAINT EMP_DIR_FK 
						REFERENCES EMPLE ON DELETE SET NULL,
 	FECHA_ALT DATE,
 	SALARIO   NUMBER(10),
 	COMISION  NUMBER(10),
 	DEPT_NO   NUMBER(2) NOT NULL 
						CONSTRAINT EMP_DEP_FK 
						REFERENCES DEPART ON DELETE CASCADE);
DESC EMPLE;
ALTER TABLE EMPLE MODIFY DEPT_NO NOT NULL;
ALTER TABLE EMPLE ADD CONSTRAINT EMP_DEP_NN CHECK(DEPT_NO IS NOT NULL);

INSERT INTO EMPLE VALUES (7839,'REY','PRESIDENTE',NULL,'17/12/1981',650000,NULL,10);
INSERT INTO EMPLE VALUES (7566,'JIMENEZ','DIRECTOR',7839,'02/04/1981',386750,NULL,20);
INSERT INTO EMPLE VALUES (7698,'NEGRO','DIRECTOR',7839,'01/05/1981',370500,NULL,30);
INSERT INTO EMPLE VALUES (7782,'CEREZO','DIRECTOR',7839,'09/06/1981',318500,NULL,10);
INSERT INTO EMPLE VALUES (7788,'GIL','ANALISTA',7566,'09/11/1981',390000,NULL,20);
INSERT INTO EMPLE VALUES (7902,'FERNANDEZ','ANALISTA',7566,'03/12/1981',390000,NULL,20);
INSERT INTO EMPLE VALUES (7499,'ARROYO','VENDEDOR',7698,'20/02/1980',208000,39000,30);
INSERT INTO EMPLE VALUES (7521,'SALA','VENDEDOR',7698,'22/02/1981',162500,65000,30);
INSERT INTO EMPLE VALUES (7654,'MARTIN','VENDEDOR',7698,'29/09/1981',162500,182000,30);
INSERT INTO EMPLE VALUES (7844,'TOVAR','VENDEDOR',7698,'08/09/1981',195000,0,30);
INSERT INTO EMPLE VALUES (7900,'JIMENO','EMPLEADO',7698,'03/12/1981',123500,NULL,30);
INSERT INTO EMPLE VALUES (7369,'SANCHEZ','EMPLEADO',7902,'17/12/1980',104000,NULL,20);
INSERT INTO EMPLE VALUES (7876,'ALONSO','EMPLEADO',7788,'23/09/1981',143000,NULL,20);
INSERT INTO EMPLE VALUES (7934,'MUÑOZ','EMPLEADO',7782,'23/01/1982',169000,NULL,10);

SELECT * FROM EMPLE;